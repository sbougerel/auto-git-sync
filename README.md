<a href="https://github.com/sbougerel/autosync-magit"><img src="https://www.gnu.org/software/emacs/images/emacs.png" alt="Emacs Logo" width="80" height="80" align="right"></a>
## autosync-magit.el
*Automatically synchronize content with upstream via magit*

---

[![License GPLv3](https://img.shields.io/badge/license-GPL_v3-green.svg)](http://www.gnu.org/licenses/gpl-3.0.html)
[![CI Result](https://github.com/sbougerel/autosync-magit/actions/workflows/makefile.yml/badge.svg)](https://github.com/sbougerel/autosync-magit/actions)

This package provides a minor mode to automatically synchronise a local git
repository branch with its upstream.  It is intended to be used
exceptionally: when git is used solely to synchronise private content between
devices.  It should never be used with typical repositories and especially
not for team settings.  A typical use case consists in synchronising your
personal notes between devices.

### Installation


With `straight.el` and `use-package.el`, add this to your `~/.emacs.d/init.el`:

```elisp
(use-package autosync-magit
 :straight (:host github
            :repo "sbougerel/autosync-magit"
            :files ("*.el"))
 :config
 (setq autosync-magit-dirs
       (list (cons "~/dir/to/sync" "Commit message")))
 (global-autosync-magit-mode 1))
 ```

And restart Emacs.  If you're using Doom Emacs, add this to your
`~/.doom.d/packages.el`:

```elisp
(package! autosync-magit
  :recipe (:host github
           :repo "sbougerel/autosync-magit"
           :files ("*.el")))
```

Then add the following to `~/.doom.d/config.el`:

```elisp
(use-package! autosync-magit
 :config
 (setq autosync-magit-dirs
       (list (cons "~/dir/to/sync" "Commit message")))
 (global-autosync-magit-mode 1))
```

Then run `doom sync` to install it.




### Customization Documentation

#### `autosync-magit-pull-interval`

Buffer-local minimum interval between pull attempts, in seconds.

When the buffer window is selected (i.e. becomes active),
`autosync-magit` attempts to pull updates from the remotes.  This
variable ensures this is not done overly frequently.

#### `autosync-magit-push-debounce`

Duration in seconds that must elapse before push can be called again.

When you save a buffer, wait for `autosync-magit-push-debounce`
to elapse before pushing to the remote (again). This ensures that
multiple file saves in a short period of time do not result in
multiple pushes.

#### `autosync-magit-dirs`

Alist of `(REPO_DIR . MESSAGE)` that should be synchronised.

REPO_DIR is the top-level directory of the repository to synchronise.
MESSAGE is the commit message to use when committing changes.

### Function and Macro Documentation

#### `(autosync-magit-pull REPO_DIR)`

Do `git fetch` then `git merge` from REPO_DIR.
This interactive function does not check wether the repository
belongs to `autosync-magit-dirs`. It is not thorttled either.

#### `(autosync-magit-push REPO_DIR MESSAGE)`

Do `git add -A`, `git commit -m -a MESSAGE` then `git push` from REPO_DIR.
This interactive function does not check wether the repository
belongs to `autosync-magit-dirs`. It is not debounced either.

-----
<div style="padding-top:15px;color: #d0d0d0;">
Markdown README file generated by
<a href="https://github.com/mgalgs/make-readme-markdown">make-readme-markdown.el</a>
</div>
